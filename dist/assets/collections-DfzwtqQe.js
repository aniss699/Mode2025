import{r as c,j as e}from"./ui-D9tbKjPW.js";import{u as E}from"./useQuery-oiTehjeD.js";import{a as Y,u as _,e as ee,f as j,B as l,g as T,D as S,h as te,P as D,i as I,j as z,k as q,l as L,I as $,b as M,c as O,G as se,d as A,H as f,E as F,S as ie,q as N}from"./index-cx1k--0o.js";import{T as V}from"./textarea-B5LBe6fx.js";import{I as K}from"./image-dp0gFKdP.js";import{L as le}from"./lock-BqwgwAiI.js";import{S as ae}from"./square-pen-CQ9tZXaQ.js";import{T as oe}from"./trash-2-xPSD6Emh.js";import"./vendor-D3F3s8fL.js";function ge(){const{user:r}=Y(),[,d]=_(),[m,y]=c.useState("my-collections"),[Z,x]=c.useState(!1),[B,u]=c.useState(!1),[s,o]=c.useState(null),[n,p]=c.useState({title:"",description:"",isPublic:!0}),{toast:a}=ee(),{data:C=[],isLoading:H}=E({queryKey:["/api/collections",r?.id],enabled:!!r?.id}),{data:w=[],isLoading:Q}=E({queryKey:["/api/saved-looks",r?.id],enabled:!!r?.id}),R=[{id:1,title:"Looks d'été 2024",description:"Ma collection de tenues estivales fraîches et colorées",coverImage:"https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?w=400&h=400&fit=crop",looksCount:24,followersCount:156,isPublic:!0,createdAt:"2024-01-15T00:00:00Z"},{id:2,title:"Style Minimaliste",description:"Capsule wardrobe essentials et looks intemporels",coverImage:"https://images.unsplash.com/photo-1483985988355-763728e1935b?w=400&h=400&fit=crop",looksCount:18,followersCount:234,isPublic:!0,createdAt:"2024-02-20T00:00:00Z"},{id:3,title:"Soirées Chic",description:"Tenues élégantes pour occasions spéciales",coverImage:"https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=400&h=400&fit=crop",looksCount:12,followersCount:89,isPublic:!1,createdAt:"2024-03-10T00:00:00Z"}],U=[{id:1,title:"Street Style Parisien",coverImage:"https://images.unsplash.com/photo-1469334031218-e382a71b716b?w=400&h=400&fit=crop",creator:{name:"Sophie Martin",username:"@sophiestyle"},likesCount:456,savedAt:"2024-03-15T00:00:00Z"},{id:2,title:"Casual Chic Automne",coverImage:"https://images.unsplash.com/photo-1509631179647-0177331693ae?w=400&h=400&fit=crop",creator:{name:"Emma Dubois",username:"@emmafashion"},likesCount:892,savedAt:"2024-03-12T00:00:00Z"}],h=C.length>0?C:R,g=w.length>0?w:U,v=j({mutationFn:async t=>{const i=await fetch("/api/collections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to create collection");return i.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/collections"]}),a({title:"Collection créée",description:"Votre collection a été créée avec succès."}),x(!1),p({title:"",description:"",isPublic:!0})},onError:()=>{a({title:"Erreur",description:"Impossible de créer la collection.",variant:"destructive"})}}),k=j({mutationFn:async t=>{const i=await fetch(`/api/collections/${t}`,{method:"DELETE"});if(!i.ok)throw new Error("Failed to delete collection");return i.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/collections"]}),a({title:"Collection supprimée",description:"Votre collection a été supprimée avec succès."})},onError:()=>{a({title:"Erreur",description:"Impossible de supprimer la collection.",variant:"destructive"})}}),b=j({mutationFn:async({id:t,data:i})=>{const P=await fetch(`/api/collections/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!P.ok)throw new Error("Failed to update collection");return P.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/collections"]}),a({title:"Collection modifiée",description:"Votre collection a été mise à jour avec succès."}),u(!1),o(null)},onError:()=>{a({title:"Erreur",description:"Impossible de modifier la collection.",variant:"destructive"})}}),G=t=>{window.confirm("Êtes-vous sûr de vouloir supprimer cette collection ?")&&k.mutate(t)},J=()=>{if(!n.title.trim()){a({title:"Titre requis",description:"Veuillez entrer un titre pour votre collection.",variant:"destructive"});return}v.mutate(n)},W=t=>{o(t),u(!0)},X=()=>{if(!s||!s.title.trim()){a({title:"Titre requis",description:"Veuillez entrer un titre pour votre collection.",variant:"destructive"});return}b.mutate({id:s.id,data:{title:s.title,description:s.description,isPublic:s.isPublic}})};return r?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-pink-100 to-purple-100 rounded-full px-4 py-2 mb-3",children:[e.jsx(T,{className:"w-4 h-4 text-pink-600"}),e.jsx("span",{className:"text-sm font-semibold text-purple-700",children:"Organisez votre inspiration"})]}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-2 bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:"Mes Collections"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Créez des collections thématiques et organisez vos looks préférés"})]}),e.jsxs(S,{open:Z,onOpenChange:x,children:[e.jsx(te,{asChild:!0,children:e.jsxs(l,{"data-testid":"button-create-collection",size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:[e.jsx(D,{className:"mr-2 h-5 w-5"}),"Nouvelle Collection"]})}),e.jsxs(I,{children:[e.jsxs(z,{children:[e.jsx(q,{children:"Créer une nouvelle collection"}),e.jsx(L,{children:"Organisez vos looks favoris dans des collections thématiques"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Titre de la collection"}),e.jsx($,{"data-testid":"input-collection-title",placeholder:"Ex: Looks d'été, Style minimaliste...",value:n.title,onChange:t=>p(i=>({...i,title:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Description"}),e.jsx(V,{"data-testid":"input-collection-description",placeholder:"Décrivez votre collection...",value:n.description,onChange:t=>p(i=>({...i,description:t.target.value})),rows:3})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{"data-testid":"checkbox-collection-public",type:"checkbox",id:"isPublic",checked:n.isPublic,onChange:t=>p(i=>({...i,isPublic:t.target.checked})),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"isPublic",className:"text-sm text-gray-700",children:"Rendre cette collection publique"})]}),e.jsx(l,{"data-testid":"button-submit-collection",onClick:J,disabled:v.isPending,className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:v.isPending?"Création...":"Créer la collection"})]})]})]})]})})}),e.jsx(S,{open:B,onOpenChange:t=>{u(t),t||o(null)},children:e.jsxs(I,{children:[e.jsxs(z,{children:[e.jsx(q,{children:"Modifier la collection"}),e.jsx(L,{children:"Modifiez les informations de votre collection"})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Titre de la collection"}),e.jsx($,{"data-testid":"input-edit-collection-title",placeholder:"Ex: Looks d'été, Style minimaliste...",value:s.title,onChange:t=>o({...s,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Description"}),e.jsx(V,{"data-testid":"input-edit-collection-description",placeholder:"Décrivez votre collection...",value:s.description,onChange:t=>o({...s,description:t.target.value}),rows:3})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{"data-testid":"checkbox-edit-collection-public",type:"checkbox",id:"editIsPublic",checked:s.isPublic,onChange:t=>o({...s,isPublic:t.target.checked}),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"editIsPublic",className:"text-sm text-gray-700",children:"Rendre cette collection publique"})]}),e.jsx(l,{"data-testid":"button-update-collection",onClick:X,disabled:b.isPending,className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:b.isPending?"Modification...":"Enregistrer les modifications"})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"border-b border-gray-200 mb-8",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{"data-testid":"tab-my-collections",onClick:()=>y("my-collections"),className:`py-3 px-1 border-b-2 font-medium text-sm sm:text-base ${m==="my-collections"?"border-pink-500 text-pink-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Mes collections (",h.length,")"]}),e.jsxs("button",{"data-testid":"tab-saved-looks",onClick:()=>y("saved"),className:`py-3 px-1 border-b-2 font-medium text-sm sm:text-base ${m==="saved"?"border-pink-500 text-pink-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Looks sauvegardés (",g.length,")"]})]})}),m==="my-collections"&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:H?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Chargement..."})]}):h.length>0?h.map(t=>e.jsxs(M,{className:"overflow-hidden hover:shadow-xl transition-shadow group","data-testid":`card-collection-${t.id}`,children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gray-100",children:[t.coverImage?e.jsx("img",{src:t.coverImage,alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(K,{className:"w-16 h-16 text-gray-300"})}),e.jsx("div",{className:"absolute top-3 right-3",children:t.isPublic?e.jsxs(O,{className:"bg-green-500 text-white",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"Public"]}):e.jsxs(O,{variant:"secondary",children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"Privé"]})})]}),e.jsxs(A,{className:"p-5",children:[e.jsx("h3",{className:"font-bold text-lg mb-2","data-testid":`text-collection-title-${t.id}`,children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.looksCount," looks"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:t.followersCount})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{"data-testid":`button-view-collection-${t.id}`,variant:"outline",size:"sm",className:"flex-1",onClick:()=>d(`/collections/${t.id}`),children:[e.jsx(F,{className:"w-4 h-4 mr-1"}),"Voir"]}),e.jsx(l,{"data-testid":`button-edit-collection-${t.id}`,variant:"outline",size:"sm",onClick:()=>W(t),children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx(l,{"data-testid":`button-delete-collection-${t.id}`,variant:"outline",size:"sm",onClick:()=>G(t.id),className:"text-red-600 hover:text-red-700",disabled:k.isPending,children:e.jsx(oe,{className:"w-4 h-4"})})]})]})]},t.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(T,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Vous n'avez pas encore de collections"}),e.jsxs(l,{"data-testid":"button-create-first-collection",onClick:()=>x(!0),className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Créer ma première collection"]})]})}),m==="saved"&&e.jsx("div",{className:"grid md:grid-cols-3 lg:grid-cols-4 gap-6",children:Q?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Chargement..."})]}):g.length>0?g.map(t=>e.jsxs(M,{className:"overflow-hidden hover:shadow-xl transition-shadow group","data-testid":`card-saved-look-${t.id}`,children:[e.jsx("div",{className:"relative aspect-[3/4] overflow-hidden",children:e.jsx("img",{src:t.coverImage,alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})}),e.jsxs(A,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-1","data-testid":`text-look-title-${t.id}`,children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["par ",t.creator.username]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-3 h-3 fill-current text-pink-500"}),e.jsx("span",{children:t.likesCount})]}),e.jsx(l,{"data-testid":`button-view-look-${t.id}`,variant:"ghost",size:"sm",onClick:()=>d(`/looks/${t.id}`),children:e.jsx(F,{className:"w-4 h-4"})})]})]})]},t.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(f,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Aucun look sauvegardé"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Explorez le feed et sauvegardez vos looks préférés"}),e.jsxs(l,{"data-testid":"button-explore-feed",onClick:()=>d("/feed"),className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Explorer le feed"]})]})})]})]}):e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Veuillez vous connecter pour voir vos collections"}),e.jsx(l,{onClick:()=>d("/login"),children:"Se connecter"})]})})}export{ge as default};
