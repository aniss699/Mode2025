import{r as C,j as e}from"./ui-BcXBiFQq.js";import{u as De}from"./useQuery-8TP4fbV0.js";import{c as ye,a as ae,E as Ge,F as Ye,r as S,I as z,B as k,K as Ze,f as pe,e as we,U as I,l as Y,P as me,C as y,b as T,h as A,j as ue,X as Ne,d as w,V as ke,m as es,W as ss,Z as Te,A as ie,T as Ae,n as Re,Y as ts,D as ze,t as $e,v as Ee,w as Fe,x as Le,g as as,_ as rs,u as is,N as Pe}from"./index-4tj7xDnq.js";import{d as ls}from"./services-B2lohCTD.js";import{f as le,g as ns,a as cs}from"./categories-x35FBw14.js";import{T as U}from"./textarea-BRJgHq63.js";import{T as Ie,a as Be,b as J,c as H}from"./tabs-JLlQfbae.js";import{S as ne,a as ce,b as de,c as oe,d as $}from"./select-BWnhroCy.js";import{B as _}from"./badge-DPx3P7Eg.js";import{S as B}from"./star-CPoqgR-e.js";import{E as Z}from"./euro-PFOnIITo.js";import{C as se}from"./calendar-Dct_a8J7.js";import{S as ds}from"./switch-DIBNz6hA.js";import{U as Ve}from"./user-plus-JBp62Ax4.js";import{L as os}from"./lock-B6KKRIIN.js";import{B as be}from"./brain-DVhqmkdB.js";import{T as _e,C as ms}from"./triangle-alert-D0soHJbw.js";import{T as us}from"./trending-up-e2L-2c3A.js";import{A as ee}from"./award-LQajR1Mu.js";import{M as te}from"./message-circle-CjYGmr8a.js";import{C as xs}from"./circle-plus-Bj2RYTzv.js";import{b as fe,a as X,c as G,d as ps,C as hs,f as W}from"./calendar-xrrDgwvU.js";import{C as xe}from"./clock-86fLZAz-.js";import{T as gs}from"./trash-2-CYcXjteh.js";import{S as js}from"./save-4PbxGZd-.js";import{M as We}from"./map-pin-CMj5-q9X.js";import{P as bs}from"./phone-52Be5kqY.js";import{C as fs}from"./circle-alert-pDwW62sR.js";import{F as vs}from"./file-text-BNKfLUIq.js";import"./vendor-D3F3s8fL.js";import"./index-DIYLGAU4.js";import"./chevron-up-lxjrQhkN.js";import"./chevron-left-pC-KFp0t.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=ye("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=ye("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=ye("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),ys={lessThanXSeconds:{one:"moins dâ€™une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dâ€™une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dâ€™un an",other:"plus de {{count}} ans"},almostXYears:{one:"presquâ€™un an",other:"presque {{count}} ans"}},ws=(n,b,p)=>{let a;const h=ys[n];return typeof h=="string"?a=h:b===1?a=h.one:a=h.other.replace("{{count}}",String(b)),p?.addSuffix?p.comparison&&p.comparison>0?"dans "+a:"il y a "+a:a},ks={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},Cs={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Ms={full:"{{date}} 'Ã ' {{time}}",long:"{{date}} 'Ã ' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ss={date:fe({formats:ks,defaultWidth:"full"}),time:fe({formats:Cs,defaultWidth:"full"}),dateTime:fe({formats:Ms,defaultWidth:"full"})},Ps={lastWeek:"eeee 'dernier Ã ' p",yesterday:"'hier Ã ' p",today:"'aujourdâ€™hui Ã ' p",tomorrow:"'demain Ã ' p'",nextWeek:"eeee 'prochain Ã ' p",other:"P"},_s=(n,b,p,a)=>Ps[n],qs={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant JÃ©sus-Christ","aprÃ¨s JÃ©sus-Christ"]},Ds={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2Ã¨me trim.","3Ã¨me trim.","4Ã¨me trim."],wide:["1er trimestre","2Ã¨me trimestre","3Ã¨me trimestre","4Ã¨me trimestre"]},Ts={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fÃ©vr.","mars","avr.","mai","juin","juil.","aoÃ»t","sept.","oct.","nov.","dÃ©c."],wide:["janvier","fÃ©vrier","mars","avril","mai","juin","juillet","aoÃ»t","septembre","octobre","novembre","dÃ©cembre"]},As={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},Rs={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprÃ¨s-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de lâ€™aprÃ¨s-midi",evening:"du soir",night:"du matin"}},zs=(n,b)=>{const p=Number(n),a=b?.unit;if(p===0)return"0";const h=["year","week","hour","minute","second"];let o;return p===1?o=a&&h.includes(a)?"Ã¨re":"er":o="Ã¨me",p+o},$s=["MMM","MMMM"],Es={preprocessor:(n,b)=>n.getDate()===1||!b.some(a=>a.isToken&&$s.includes(a.value))?b:b.map(a=>a.isToken&&a.value==="do"?{isToken:!0,value:"d"}:a),ordinalNumber:zs,era:X({values:qs,defaultWidth:"wide"}),quarter:X({values:Ds,defaultWidth:"wide",argumentCallback:n=>n-1}),month:X({values:Ts,defaultWidth:"wide"}),day:X({values:As,defaultWidth:"wide"}),dayPeriod:X({values:Rs,defaultWidth:"wide"})},Fs=/^(\d+)(iÃ¨me|Ã¨re|Ã¨me|er|e)?/i,Ls=/\d+/i,Is={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant JÃ©sus-Christ|aprÃ¨s JÃ©sus-Christ)/i},Bs={any:[/^av/i,/^ap/i]},Vs={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|Ã¨me|e)? trim\.?/i,wide:/^[1234](er|Ã¨me|e)? trimestre/i},Ws={any:[/1/i,/2/i,/3/i,/4/i]},Os={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fÃ©vr|mars|avr|mai|juin|juill|juil|aoÃ»t|sept|oct|nov|dÃ©c)\.?/i,wide:/^(janvier|fÃ©vrier|mars|avril|mai|juin|juillet|aoÃ»t|septembre|octobre|novembre|dÃ©cembre)/i},Js={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Hs={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},Us={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Ks={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprÃ¨s[-\s]midi|du soir|de la nuit)/i},Qs={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},Xs={ordinalNumber:ps({matchPattern:Fs,parsePattern:Ls,valueCallback:n=>parseInt(n)}),era:G({matchPatterns:Is,defaultMatchWidth:"wide",parsePatterns:Bs,defaultParseWidth:"any"}),quarter:G({matchPatterns:Vs,defaultMatchWidth:"wide",parsePatterns:Ws,defaultParseWidth:"any",valueCallback:n=>n+1}),month:G({matchPatterns:Os,defaultMatchWidth:"wide",parsePatterns:Js,defaultParseWidth:"any"}),day:G({matchPatterns:Hs,defaultMatchWidth:"wide",parsePatterns:Us,defaultParseWidth:"any"}),dayPeriod:G({matchPatterns:Ks,defaultMatchWidth:"any",parsePatterns:Qs,defaultParseWidth:"any"})},qe={code:"fr",formatDistance:ws,formatLong:Ss,formatRelative:_s,localize:Es,match:Xs,options:{weekStartsOn:1,firstWeekContainsDate:4}};function Oe({missionId:n,onSuccess:b}){const{user:p}=ae(),[a,h]=C.useState({amount:"",timeline:"",proposal:""}),o=Ge("/api/bids",{successMessage:"ðŸš€ Offre envoyÃ©e avec succÃ¨s !",errorContext:"Soumission d'offre",invalidateQueries:[["/api/missions",n],["/api/missions"],["/api/users",p?.id,"bids"]],onSuccess:()=>{h({amount:"",timeline:"",proposal:""}),b()}}),N=Ye({onSubmit:async u=>{o.mutate(u)},validateBeforeSubmit:Ze.validateBid}),r=u=>{if(u.preventDefault(),!p){N.handleError(new Error("Vous devez Ãªtre connectÃ© pour postuler"),"Authentification requise");return}N.handleSubmit({mission_id:parseInt(n),provider_id:p.id,price:a.amount,timeline_days:a.timeline?parseInt(a.timeline):void 0,message:a.proposal,bid_type:"individual"})},i=(u,f)=>{h(M=>({...M,[u]:f}))};return!p||p.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"amount",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"}),e.jsx("span",{children:"Prix proposÃ© (â‚¬)"})]}),e.jsx(z,{id:"amount",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:a.amount,onChange:u=>i("amount",u.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0,"data-testid":"input-bid-price"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"â±ï¸"}),e.jsx("span",{children:"DÃ©lai de livraison"})]}),e.jsx(z,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:a.timeline,onChange:u=>i("timeline",u.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0,"data-testid":"input-bid-timeline"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ“"}),e.jsx("span",{children:"DÃ©crivez votre proposition"})]}),e.jsx(U,{id:"proposal",placeholder:"Expliquez votre approche, votre expÃ©rience pertinente et ce que vous allez concrÃ¨tement livrer pour cette mission...",value:a.proposal,onChange:u=>i("proposal",u.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0,"data-testid":"textarea-bid-proposal"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(k,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:o.isPending||N.isSubmitting,"data-testid":"button-submit-bid",children:o.isPending||N.isSubmitting?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸš€"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function Gs({missionId:n,onSuccess:b}){const{user:p}=ae(),{toast:a}=pe(),h=we(),[o,N]=C.useState(!1),[r,i]=C.useState({amount:"",timeline_days:"",message:""}),[u,f]=C.useState([{name:p?.name||"",role:"Chef d'Ã©quipe",experience:"5+ annÃ©es",isLead:!0,rating:4.5}]),M=()=>{const x={name:"",role:"",experience:"",isLead:!1,rating:4};f([...u,x])},P=(x,m,t)=>{const s=[...u];s[x]={...s[x],[m]:t},f(s)},q=x=>{if(x===0)return;const m=u.filter((t,s)=>s!==x);f(m)},D=async x=>{if(x.preventDefault(),!p){a({title:"Erreur",description:"Vous devez Ãªtre connectÃ© pour soumettre une offre",variant:"destructive"});return}if(!r.amount||!r.timeline_days||!r.message){a({title:"Erreur",description:"Veuillez remplir tous les champs obligatoires",variant:"destructive"});return}if(u.length<2){a({title:"Erreur",description:"Une Ã©quipe doit avoir au moins 2 membres",variant:"destructive"});return}if(u.filter(t=>!t.name||!t.role||!t.experience).length>0){a({title:"Erreur",description:"Veuillez complÃ©ter les informations de tous les membres de l'Ã©quipe",variant:"destructive"});return}N(!0);try{const t={members:u,total_budget:parseInt(r.amount),estimated_timeline:parseInt(r.timeline_days),description:r.message},g=await(await ke("POST","/api/bids",{mission_id:parseInt(n),price:r.amount,timeline_days:parseInt(r.timeline_days),message:r.message,bid_type:"team",team_composition:t,team_lead_id:p.id})).json();a({title:"âœ… Candidature d'Ã©quipe soumise !",description:`Votre Ã©quipe de ${u.length} membres a Ã©tÃ© proposÃ©e avec succÃ¨s.`}),h.invalidateQueries({queryKey:["mission-detail",n]}),h.invalidateQueries({queryKey:["missions"]}),b()}catch(t){console.error("Erreur soumission candidature Ã©quipe:",t),a({title:"Erreur",description:t instanceof Error?t.message:"Impossible de soumettre la candidature",variant:"destructive"})}finally{N(!1)}};return!p||p.type!=="provider"?null:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Candidature d'Ã©quipe"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"PrÃ©sentez votre Ã©quipe prÃ©-constituÃ©e pour cette mission"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Composition de l'Ã©quipe"]}),e.jsxs(k,{type:"button",variant:"outline",size:"sm",onClick:M,"data-testid":"button-add-member",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),e.jsx("div",{className:"space-y-3",children:u.map((x,m)=>e.jsxs(y,{className:`${x.isLead?"ring-2 ring-purple-200 bg-purple-50":"bg-gray-50"}`,children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{className:"text-sm flex items-center gap-2",children:x.isLead?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 text-purple-600"}),"Chef d'Ã©quipe"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4"}),"Membre ",m]})}),!x.isLead&&e.jsx(k,{type:"button",variant:"ghost",size:"sm",onClick:()=>q(m),"data-testid":`button-remove-member-${m}`,children:e.jsx(Ne,{className:"w-4 h-4"})})]})}),e.jsxs(w,{className:"pt-0 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"Nom complet *"}),e.jsx(z,{placeholder:"Nom du membre",value:x.name,onChange:t=>P(m,"name",t.target.value),disabled:x.isLead,"data-testid":`input-member-name-${m}`})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"RÃ´le/SpÃ©cialitÃ© *"}),e.jsx(z,{placeholder:"Ex: DÃ©veloppeur Frontend",value:x.role,onChange:t=>P(m,"role",t.target.value),"data-testid":`input-member-role-${m}`})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"ExpÃ©rience *"}),e.jsxs(ne,{value:x.experience,onValueChange:t=>P(m,"experience",t),children:[e.jsx(ce,{"data-testid":`select-member-experience-${m}`,children:e.jsx(de,{placeholder:"Niveau d'expÃ©rience"})}),e.jsxs(oe,{children:[e.jsx($,{value:"1-2 annÃ©es",children:"1-2 annÃ©es"}),e.jsx($,{value:"3-5 annÃ©es",children:"3-5 annÃ©es"}),e.jsx($,{value:"5+ annÃ©es",children:"5+ annÃ©es"}),e.jsx($,{value:"10+ annÃ©es",children:"10+ annÃ©es"})]})]})]})]})]},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"team-amount",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Prix total Ã©quipe (â‚¬) *"]}),e.jsx(z,{id:"team-amount",type:"number",placeholder:"15000",min:"100",value:r.amount,onChange:x=>i(m=>({...m,amount:x.target.value})),"data-testid":"input-team-amount"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Montant global pour toute l'Ã©quipe"})]}),e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"team-timeline",className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"DÃ©lai (jours) *"]}),e.jsx(z,{id:"team-timeline",type:"number",placeholder:"30",min:"1",value:r.timeline_days,onChange:x=>i(m=>({...m,timeline_days:x.target.value})),"data-testid":"input-team-timeline"})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"team-message",className:"text-base font-medium",children:"Proposition dÃ©taillÃ©e *"}),e.jsx(U,{id:"team-message",placeholder:"DÃ©crivez comment votre Ã©quipe va rÃ©aliser cette mission, la rÃ©partition des tÃ¢ches, votre mÃ©thodologie...",rows:5,value:r.message,onChange:x=>i(m=>({...m,message:x.target.value})),"data-testid":"textarea-team-message"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"DÃ©taillez la stratÃ©gie de votre Ã©quipe pour cette mission"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 border",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"RÃ©capitulatif de l'Ã©quipe"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Membres:"}),e.jsxs(_,{variant:"secondary",children:[u.length," personnes"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Budget total:"}),e.jsxs(_,{variant:"secondary",children:[r.amount||"0","â‚¬"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"DÃ©lai:"}),e.jsxs(_,{variant:"secondary",children:[r.timeline_days||"0"," jours"]})]})]})]}),e.jsx(k,{type:"submit",className:"w-full bg-purple-600 hover:bg-purple-700",disabled:o,"data-testid":"button-submit-team-bid",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Soumission en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Soumettre la candidature d'Ã©quipe"]})})]})}function Ys({missionId:n,onSuccess:b}){const{user:p}=ae(),{toast:a}=pe(),h=we(),[o,N]=C.useState(!1),[r,i]=C.useState({name:"",description:"",estimated_budget:"",estimated_timeline_days:"",max_members:"5",visibility:"public",auto_accept:!0}),[u,f]=C.useState([{title:"",description:"",skills:[],min_experience:1,priority:"medium"}]),M=()=>{const t={title:"",description:"",skills:[],min_experience:1,priority:"medium"};f([...u,t])},P=(t,s,g)=>{const v=[...u];v[t]={...v[t],[s]:g},f(v)},q=t=>{if(u.length<=1)return;const s=u.filter((g,v)=>v!==t);f(s)},D=(t,s)=>{if(!s.trim())return;const g=[...u],v=g[t].skills;v.includes(s.trim())||(g[t].skills=[...v,s.trim()],f(g))},x=(t,s)=>{const g=[...u];g[t].skills=g[t].skills.filter((v,K)=>K!==s),f(g)},m=async t=>{if(t.preventDefault(),!p){a({title:"Erreur",description:"Vous devez Ãªtre connectÃ© pour crÃ©er une Ã©quipe ouverte",variant:"destructive"});return}if(!r.name||!r.description||!r.estimated_budget||!r.estimated_timeline_days){a({title:"Erreur",description:"Veuillez remplir tous les champs obligatoires",variant:"destructive"});return}const s=u.filter(g=>g.title.trim());if(s.length===0){a({title:"Erreur",description:"Veuillez dÃ©finir au moins un rÃ´le recherchÃ©",variant:"destructive"});return}N(!0);try{const v=await(await ke("POST","/api/open-teams",{mission_id:parseInt(n),name:r.name,description:r.description,estimated_budget:parseInt(r.estimated_budget)*100,estimated_timeline_days:parseInt(r.estimated_timeline_days),max_members:parseInt(r.max_members),visibility:r.visibility,auto_accept:r.auto_accept,required_roles:s,members:[{user_id:p.id,name:p.name,role:"Initiateur",experience_years:5,rating:4.5,joined_at:new Date().toISOString()}]})).json();a({title:"ðŸš€ Ã‰quipe ouverte crÃ©Ã©e !",description:`${r.name} est maintenant ouverte au recrutement.`}),h.invalidateQueries({queryKey:["mission-detail",n]}),h.invalidateQueries({queryKey:["open-teams"]}),b()}catch(g){console.error("Erreur crÃ©ation Ã©quipe ouverte:",g),a({title:"Erreur",description:g instanceof Error?g.message:"Impossible de crÃ©er l'Ã©quipe ouverte",variant:"destructive"})}finally{N(!1)}};return!p||p.type!=="provider"?null:e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center justify-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"CrÃ©er une Ã©quipe ouverte"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Initiez une Ã©quipe oÃ¹ d'autres prestataires peuvent vous rejoindre"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"team-name",className:"text-base font-medium",children:"Nom de l'Ã©quipe *"}),e.jsx(z,{id:"team-name",placeholder:"Ex: Ã‰quipe DÃ©veloppement Web Pro",value:r.name,onChange:t=>i(s=>({...s,name:t.target.value})),"data-testid":"input-team-name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"team-description",className:"text-base font-medium",children:"Description de l'Ã©quipe *"}),e.jsx(U,{id:"team-description",placeholder:"DÃ©crivez votre approche, votre vision pour cette mission...",rows:3,value:r.description,onChange:t=>i(s=>({...s,description:t.target.value})),"data-testid":"textarea-team-description"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"estimated-budget",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Budget estimÃ© (â‚¬) *"]}),e.jsx(z,{id:"estimated-budget",type:"number",placeholder:"10000",min:"100",value:r.estimated_budget,onChange:t=>i(s=>({...s,estimated_budget:t.target.value})),"data-testid":"input-estimated-budget"})]}),e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"estimated-timeline",className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"DÃ©lai estimÃ© (jours) *"]}),e.jsx(z,{id:"estimated-timeline",type:"number",placeholder:"45",min:"1",value:r.estimated_timeline_days,onChange:t=>i(s=>({...s,estimated_timeline_days:t.target.value})),"data-testid":"input-estimated-timeline"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"RÃ´les recherchÃ©s"]}),e.jsxs(k,{type:"button",variant:"outline",size:"sm",onClick:M,"data-testid":"button-add-role",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),e.jsx("div",{className:"space-y-3",children:u.map((t,s)=>e.jsxs(y,{className:"bg-orange-50 border-orange-200",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(A,{className:"text-sm",children:["RÃ´le ",s+1]}),u.length>1&&e.jsx(k,{type:"button",variant:"ghost",size:"sm",onClick:()=>q(s),"data-testid":`button-remove-role-${s}`,children:e.jsx(Ne,{className:"w-4 h-4"})})]})}),e.jsxs(w,{className:"pt-0 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"Titre du poste *"}),e.jsx(z,{placeholder:"Ex: DÃ©veloppeur React",value:t.title,onChange:g=>P(s,"title",g.target.value),"data-testid":`input-role-title-${s}`})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"PrioritÃ©"}),e.jsxs(ne,{value:t.priority,onValueChange:g=>P(s,"priority",g),children:[e.jsx(ce,{"data-testid":`select-role-priority-${s}`,children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx($,{value:"high",children:"Haute"}),e.jsx($,{value:"medium",children:"Moyenne"}),e.jsx($,{value:"low",children:"Basse"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"Description du rÃ´le"}),e.jsx(U,{placeholder:"DÃ©crivez les responsabilitÃ©s et attentes...",rows:2,value:t.description,onChange:g=>P(s,"description",g.target.value),"data-testid":`textarea-role-description-${s}`})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"CompÃ©tences requises"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.skills.map((g,v)=>e.jsxs(_,{variant:"secondary",className:"flex items-center gap-1",children:[g,e.jsx(Ne,{className:"w-3 h-3 cursor-pointer hover:text-red-500",onClick:()=>x(s,v)})]},v))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{placeholder:"Ajouter une compÃ©tence...",onKeyPress:g=>{g.key==="Enter"&&(g.preventDefault(),D(s,g.currentTarget.value),g.currentTarget.value="")},"data-testid":`input-role-skill-${s}`}),e.jsx(k,{type:"button",variant:"outline",size:"sm",onClick:g=>{const v=g.currentTarget.parentNode?.querySelector("input");v&&(D(s,v.value),v.value="")},children:e.jsx(me,{className:"w-4 h-4"})})]})]})]})]},s))})]}),e.jsxs(y,{className:"bg-gray-50",children:[e.jsx(T,{children:e.jsxs(A,{className:"text-sm flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),"ParamÃ¨tres de l'Ã©quipe"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"Nombre max de membres"}),e.jsxs(ne,{value:r.max_members,onValueChange:t=>i(s=>({...s,max_members:t})),children:[e.jsx(ce,{"data-testid":"select-max-members",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx($,{value:"3",children:"3 membres"}),e.jsx($,{value:"5",children:"5 membres"}),e.jsx($,{value:"7",children:"7 membres"}),e.jsx($,{value:"10",children:"10 membres"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm",children:"VisibilitÃ©"}),e.jsxs(ne,{value:r.visibility,onValueChange:t=>i(s=>({...s,visibility:t})),children:[e.jsx(ce,{"data-testid":"select-visibility",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx($,{value:"public",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Publique"]})}),e.jsx($,{value:"private",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"PrivÃ©e"]})})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ds,{id:"auto-accept",checked:r.auto_accept,onCheckedChange:t=>i(s=>({...s,auto_accept:t})),"data-testid":"switch-auto-accept"}),e.jsx(S,{htmlFor:"auto-accept",className:"text-sm",children:"Accepter automatiquement les candidatures"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg p-4 border",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"RÃ©capitulatif de l'Ã©quipe ouverte"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Nom:"}),e.jsx(_,{variant:"secondary",children:r.name||"Non dÃ©fini"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Budget estimÃ©:"}),e.jsxs(_,{variant:"secondary",children:[r.estimated_budget||"0","â‚¬"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Membres max:"}),e.jsxs(_,{variant:"secondary",children:[r.max_members," personnes"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"RÃ´les dÃ©finis:"}),e.jsxs(_,{variant:"secondary",children:[u.filter(t=>t.title).length," rÃ´les"]})]})]})]}),e.jsx(k,{type:"submit",className:"w-full bg-orange-600 hover:bg-orange-700",disabled:o,"data-testid":"button-submit-open-team",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"CrÃ©ation en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"CrÃ©er l'Ã©quipe ouverte"]})})]})}function Je({missionTitle:n,missionDescription:b,missionBudget:p,missionCategory:a,currentBid:h,providerProfile:o,competitorBids:N=[],onOptimizedBidGenerated:r}){const[i,u]=C.useState(null),[f,M]=C.useState(!1),[P,q]=C.useState(!1),D=async()=>{M(!0),await new Promise(je=>setTimeout(je,2e3));const l=x(n+" "+b),d=x(h.proposal),j=m(l,d),L=N.length>0?N.reduce((je,Xe)=>je+Xe.price,0)/N.length:p,R=t(h.price,L,p),V=s(o.skills,a,o.completedProjects,o.rating),Q=g(h.proposal,o),Ce=(j+V)/2,Me=(R+K(h.timeline))/2,Se=Q*.4+Ce*.3+Me*.3,He=v(Se,N.length),Ue=he({keywordRelevance:j,priceCompetitiveness:R,experienceMatch:V,proposal:h.proposal}),Ke=ge({rating:o.rating,projects:o.completedProjects,skills:o.skills,price:h.price,avgPrice:L}),Qe=re({keywordRelevance:j,priceCompetitiveness:R,proposal:h.proposal,timeline:h.timeline});u({overallScore:Se,competitivenessScore:Me,qualityScore:Q,matchScore:Ce,winProbability:He,recommendations:Ue,strengths:Ke,weaknesses:Qe,keywordRelevance:j,priceCompetitiveness:R,experienceMatch:V}),M(!1)},x=l=>{const d=["le","la","les","un","une","des","et","ou","mais","donc","or","ni","car"];return l.toLowerCase().split(/[\s,;.!?]+/).filter(j=>j.length>3&&!d.includes(j)).slice(0,10)},m=(l,d)=>{const j=l.filter(L=>d.some(R=>R.includes(L)||L.includes(R)));return Math.min(100,j.length/l.length*100)},t=(l,d,j)=>l>j?20:l<j*.3?40:l<=d*.9?90:l<=d?75:Math.max(30,70-(l-d)/d*50),s=(l,d,j,L)=>{let R=0;const V=l.filter(Q=>Q.toLowerCase().includes(d.toLowerCase())||d.toLowerCase().includes(Q.toLowerCase()));return R+=V.length/Math.max(l.length,1)*40,R+=Math.min(30,j*.5),R+=L/5*30,Math.min(100,R)},g=(l,d)=>{let j=0;l.length>200&&(j+=25),l.length>500&&(j+=15);const R=["expÃ©rience","qualitÃ©","deadline","livraison","garantie","suivi"].filter(V=>l.toLowerCase().includes(V));return j+=R.length*5,j+=d.rating/5*20,j+=Math.min(20,d.completedProjects*.2),Math.min(100,j)},v=(l,d)=>{let j=l;return d>5?j*=.8:d>10?j*=.6:d<3&&(j*=1.1),Math.min(95,Math.max(5,j))},K=l=>{const d=parseInt(l);return d<=7?85:d<=14?75:d<=30?65:45},he=l=>{const d=[];return l.keywordRelevance<60&&d.push("Incluez plus de mots-clÃ©s spÃ©cifiques Ã  la mission dans votre proposition"),l.priceCompetitiveness<50&&d.push("Votre prix semble Ã©levÃ© par rapport Ã  la concurrence, justifiez votre valeur ajoutÃ©e"),l.proposal.length<300&&d.push("DÃ©veloppez davantage votre proposition pour montrer votre comprÃ©hension du projet"),l.experienceMatch<70&&d.push("Mettez en avant votre expÃ©rience pertinente dans ce domaine"),d},ge=l=>{const d=[];return l.rating>=4.5&&d.push("Excellente rÃ©putation client"),l.projects>50&&d.push("Grande expÃ©rience avec de nombreux projets"),l.price<l.avgPrice*.9&&d.push("Prix trÃ¨s compÃ©titif"),d},re=l=>{const d=[];return l.keywordRelevance<50&&d.push("Faible correspondance avec les mots-clÃ©s de la mission"),l.priceCompetitiveness<40&&d.push("Prix potentiellement trop Ã©levÃ©"),l.proposal.length<200&&d.push("Proposition trop courte"),d},E=()=>{const l=`
Bonjour,

Votre projet "${n}" correspond parfaitement Ã  mon expertise. Avec ${o.completedProjects} projets rÃ©alisÃ©s et une note de ${o.rating}/5, je peux vous garantir une livraison de qualitÃ©.

Mon approche pour votre projet :
â€¢ Analyse dÃ©taillÃ©e de vos besoins spÃ©cifiques
â€¢ Utilisation de mes compÃ©tences en ${o.skills.join(", ")}
â€¢ Respect strict des dÃ©lais convenus
â€¢ Communication rÃ©guliÃ¨re sur l'avancement
â€¢ Garantie satisfaction client

Je propose de rÃ©aliser ce projet pour ${Math.round(h.price*.95)}â‚¬ avec livraison sous ${h.timeline}.

Ma valeur ajoutÃ©e : expÃ©rience prouvÃ©e dans ${a}, mÃ©thodologie rigoureuse et engagement qualitÃ©.

Disponible pour Ã©changer sur votre projet dÃ¨s maintenant.

Cordialement
    `.trim();u(d=>d?{...d,optimizedProposal:l}:null),q(!0),r&&r({...h,proposal:l,price:Math.round(h.price*.95)})},F=l=>l>=80?"text-green-600":l>=60?"text-yellow-600":"text-red-600",c=l=>l>=80?"bg-green-100":l>=60?"bg-yellow-100":"bg-red-100";return e.jsxs(y,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center space-x-2",children:[e.jsx(be,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Analyse IA de votre offre"}),e.jsxs(_,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(Te,{className:"w-3 h-3 mr-1"}),"Smart Algorithm"]})]})}),e.jsxs(w,{className:"space-y-6",children:[!i&&!f&&e.jsx("div",{className:"text-center py-8",children:e.jsxs(k,{onClick:D,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Analyser mon offre avec l'IA"]})}),f&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Analyse en cours avec notre algorithme propriÃ©taire..."})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-6 rounded-xl ${c(i.overallScore)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Score Global"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-3xl font-bold ${F(i.overallScore)}`,children:Math.round(i.overallScore)}),e.jsx("span",{className:"text-gray-500",children:"/100"})]})]}),e.jsx(ie,{value:i.overallScore,className:"mb-4"}),e.jsx("div",{className:"flex items-center space-x-4 text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ae,{className:"w-4 h-4 mr-1 text-blue-600"}),e.jsxs("span",{children:["ProbabilitÃ© de succÃ¨s: ",Math.round(i.winProbability),"%"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"QualitÃ©"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{value:i.qualityScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${F(i.qualityScore)}`,children:Math.round(i.qualityScore)})]})]})}),e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Correspondance"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{value:i.matchScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${F(i.matchScore)}`,children:Math.round(i.matchScore)})]})]})}),e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"CompÃ©titivitÃ©"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{value:i.competitivenessScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${F(i.competitivenessScore)}`,children:Math.round(i.competitivenessScore)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(y,{children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center text-green-600",children:[e.jsx(Re,{className:"w-5 h-5 mr-2"}),"Forces"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-2",children:i.strengths.map((l,d)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(B,{className:"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:l})]},d))})})]}),e.jsxs(y,{children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center text-orange-600",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Points d'amÃ©lioration"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-2",children:i.weaknesses.map((l,d)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(_e,{className:"w-4 h-4 text-orange-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:l})]},d))})})]})]}),e.jsxs(y,{children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center text-blue-600",children:[e.jsx(ts,{className:"w-5 h-5 mr-2"}),"Recommandations IA"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-3",children:i.recommendations.map((l,d)=>e.jsxs("li",{className:"flex items-start p-3 bg-blue-50 rounded-lg",children:[e.jsx(us,{className:"w-4 h-4 text-blue-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:l})]},d))})})]}),e.jsx("div",{className:"text-center",children:e.jsxs(k,{onClick:E,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",disabled:P,children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"GÃ©nÃ©rer une proposition optimisÃ©e"]})}),P&&i.optimizedProposal&&e.jsxs(y,{className:"border-purple-200 bg-purple-50",children:[e.jsx(T,{children:e.jsx(A,{className:"text-purple-700",children:"Proposition OptimisÃ©e par IA"})}),e.jsxs(w,{children:[e.jsx(U,{value:i.optimizedProposal,readOnly:!0,className:"min-h-[200px] bg-white"}),e.jsx("div",{className:"mt-4 text-sm text-purple-600",children:"âœ¨ Cette proposition a Ã©tÃ© gÃ©nÃ©rÃ©e pour maximiser vos chances de succÃ¨s"})]})]})]})]})]})}function Zs({mission:n,user:b,sortedBids:p,showAIAnalyzer:a,setShowAIAnalyzer:h,showBidForm:o,setShowBidForm:N}){const[r,i]=C.useState("individual"),[u,f]=C.useState(!1),[M,P]=C.useState(!1);return e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 md:p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(ee,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Candidater Ã  cette mission"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Choisissez votre mode de candidature"})]})]}),e.jsxs(Ie,{value:r,onValueChange:q=>i(q),className:"w-full",children:[e.jsxs(Be,{className:"grid w-full grid-cols-3 mb-4",children:[e.jsxs(J,{value:"individual",className:"text-xs md:text-sm data-[testid=tab-individual]","data-testid":"tab-individual",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"Solo"]}),e.jsxs(J,{value:"team",className:"text-xs md:text-sm","data-testid":"tab-team",children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"Ã‰quipe"]}),e.jsxs(J,{value:"open_team",className:"text-xs md:text-sm","data-testid":"tab-open-team",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Ã‰quipe Ouverte"]})]}),e.jsx(H,{value:"individual",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-blue-50 border-blue-200",children:[e.jsx(T,{className:"pb-3",children:e.jsxs(A,{className:"text-sm flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Candidature individuelle"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Candidatez seul Ã  cette mission avec votre expertise."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(k,{onClick:()=>h(!a),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",size:"default","data-testid":"button-ai-analyzer",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Analyser avec l'IA"]}),e.jsxs(k,{onClick:()=>N(!o),className:"w-full bg-green-600 hover:bg-green-700 text-sm",size:"default","data-testid":"button-submit-individual",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),o?"Masquer le formulaire":"Soumettre une offre"]})]}),a&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Je,{missionTitle:n.title,missionDescription:n.description,missionBudget:parseFloat(n.budget||"0"),missionCategory:n.category,currentBid:{price:0,timeline:"",proposal:""},providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:p,onOptimizedBidGenerated:q=>{N(!0)}})}),o&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Oe,{missionId:n.id,onSuccess:()=>{N(!1),h(!1)}})})]})]})}),e.jsx(H,{value:"team",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-purple-50 border-purple-200",children:[e.jsx(T,{className:"pb-3",children:e.jsxs(A,{className:"text-sm flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Candidature d'Ã©quipe"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Candidatez avec une Ã©quipe prÃ©-constituÃ©e que vous dirigez."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-white rounded-lg border",children:[e.jsx(B,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Vous Ãªtes le chef d'Ã©quipe"})]}),e.jsxs(k,{onClick:()=>f(!u),className:"w-full bg-purple-600 hover:bg-purple-700 text-sm",size:"default","data-testid":"button-submit-team",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),u?"Masquer le formulaire":"Candidater en Ã©quipe"]})]}),u&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Gs,{missionId:n.id,onSuccess:()=>{f(!1)}})})]})]})}),e.jsx(H,{value:"open_team",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-orange-50 border-orange-200",children:[e.jsx(T,{className:"pb-3",children:e.jsxs(A,{className:"text-sm flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Ã‰quipe ouverte"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"CrÃ©ez une Ã©quipe ouverte oÃ¹ d'autres prestataires peuvent vous rejoindre."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(Ve,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{children:"Recrutement ouvert"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(xs,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{children:"Collaboration"})]})]}),e.jsxs(k,{onClick:()=>P(!M),className:"w-full bg-orange-600 hover:bg-orange-700 text-sm",size:"default","data-testid":"button-submit-open-team",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),M?"Masquer le formulaire":"CrÃ©er une Ã©quipe ouverte"]})]}),M&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Ys,{missionId:n.id,onSuccess:()=>{P(!1)}})})]})]})})]})]})}function et({readOnly:n=!1,initialAvailability:b=[],onSave:p}){const[a,h]=C.useState(new Date),[o,N]=C.useState(b.map(m=>({...m,date:typeof m.date=="string"?new Date(m.date):m.date}))),[r,i]=C.useState({start:"09:00",end:"17:00",rate:50}),u=m=>o.find(t=>W(t.date,"yyyy-MM-dd")===W(m,"yyyy-MM-dd")),f=()=>{if(!a)return;const m=u(a);N(m?t=>t.map(s=>W(s.date,"yyyy-MM-dd")===W(a,"yyyy-MM-dd")?{...s,slots:[...s.slots,{...r}]}:s):t=>[...t,{date:a,slots:[{...r}]}]),i({start:"09:00",end:"17:00",rate:50})},M=async m=>{p&&p(m)},P=m=>{a&&N(t=>t.map(s=>W(s.date,"yyyy-MM-dd")===W(a,"yyyy-MM-dd")?{...s,slots:s.slots.filter((g,v)=>v!==m)}:s).filter(s=>s.slots.length>0))},q=a?u(a):null,D={available:o.map(m=>m.date)},x={available:"bg-green-100 text-green-900 font-semibold"};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(y,{className:"border-0 shadow-lg bg-gradient-to-br from-white to-blue-50",children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center text-gray-800",children:[e.jsx(xe,{className:"w-5 h-5 mr-2 text-blue-600"}),"Calendrier des disponibilitÃ©s"]})}),e.jsxs(w,{children:[e.jsx(hs,{mode:"single",selected:a,onSelect:h,locale:qe,modifiers:D,modifiersClassNames:x,className:"rounded-lg border-0 shadow-inner bg-white p-4",disabled:n?void 0:m=>m<new Date}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("span",{className:"w-3 h-3 bg-green-100 border border-green-300 rounded inline-block mr-2"}),"Jours disponibles"]})})]})]}),e.jsxs(y,{className:"border-0 shadow-lg bg-gradient-to-br from-white to-purple-50",children:[e.jsx(T,{children:e.jsx(A,{className:"text-gray-800",children:a?`CrÃ©neaux du ${W(a,"dd MMMM yyyy",{locale:qe})}`:"SÃ©lectionnez une date"})}),e.jsxs(w,{className:"space-y-4",children:[q&&q.slots.length>0?e.jsx("div",{className:"space-y-3",children:q.slots.map((m,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(_,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[m.start," - ",m.end]}),e.jsxs(_,{className:"bg-green-100 text-green-800",children:[m.rate,"â‚¬/h"]})]}),!n&&e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>P(t),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(gs,{className:"w-4 h-4"})})]},t))}):a?e.jsx("p",{className:"text-gray-500 text-center py-6 italic",children:"Aucun crÃ©neau dÃ©fini pour cette date"}):e.jsx("p",{className:"text-gray-500 text-center py-6 italic",children:"SÃ©lectionnez une date dans le calendrier"}),!n&&a&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"Ajouter un crÃ©neau"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DÃ©but"}),e.jsx(z,{type:"time",value:r.start,onChange:m=>i(t=>({...t,start:m.target.value})),className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fin"}),e.jsx(z,{type:"time",value:r.end,onChange:m=>i(t=>({...t,end:m.target.value})),className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarif (â‚¬/heure)"}),e.jsx(z,{type:"number",min:"0",step:"0.01",value:r.rate,onChange:m=>i(t=>({...t,rate:parseFloat(m.target.value)||0})),className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs(k,{onClick:f,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white",disabled:!r.start||!r.end||r.start>=r.end,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter le crÃ©neau"]})]}),!n&&p&&e.jsxs(k,{onClick:()=>M(o),className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(js,{className:"w-4 h-4 mr-2"}),"Sauvegarder les disponibilitÃ©s"]})]})]})]})}function st({providerId:n,providerName:b,isOpen:p,onClose:a}){const{toast:h}=pe(),{data:o,isLoading:N}=De({queryKey:["/api/providers",n,"profile"],enabled:!!n&&p}),r=i=>Array.from({length:5},(u,f)=>e.jsx(B,{className:`w-4 h-4 ${f<i?"text-yellow-400 fill-current":"text-gray-300"}`},f));return!p||!n?null:e.jsx(ze,{open:p,onOpenChange:a,children:e.jsxs($e,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ee,{children:[e.jsx(Fe,{children:"Profil du prestataire"}),e.jsxs(Le,{children:["Informations dÃ©taillÃ©es sur ",b]})]}),N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):o?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:o.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"w-4 h-4 mr-1"}),o.location||"Localisation non spÃ©cifiÃ©e"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"w-4 h-4 mr-1"}),"Membre depuis ",le(o.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:o.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:r(Math.round(parseFloat(o.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:o.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[o.totalProjects," projets rÃ©alisÃ©s"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.skills.map((i,u)=>e.jsx(_,{variant:"secondary",children:i},u))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(k,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${n}&name=${encodeURIComponent(b)}`},children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(k,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{h({title:"Contacter le prestataire",description:`Appelez ${b} pour discuter du projet`})},children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(k,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{h({title:"RÃ©servation de crÃ©neau",description:`FonctionnalitÃ© de rÃ©servation avec ${b} en cours de dÃ©veloppement`})},children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"RÃ©server un crÃ©neau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"RÃ©alisations rÃ©centes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:o.portfolio.slice(0,4).map(i=>e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[i.images.length>0&&e.jsx("img",{src:i.images[0],alt:i.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:i.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_,{variant:"outline",children:i.category}),e.jsx("span",{className:"text-xs text-gray-500",children:le(i.completedAt)})]})]})},i.id))}),o.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune rÃ©alisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(xe,{className:"w-5 h-5 mr-2"}),"DisponibilitÃ©s"]}),e.jsx(y,{children:e.jsx(w,{className:"p-4",children:e.jsx(et,{readOnly:!0,initialAvailability:o.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Avis clients (",o.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:o.evaluations.map(i=>e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[r(i.rating),e.jsx("span",{className:"ml-2 font-medium",children:i.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:le(i.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:i.comment}),i.photos&&i.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:i.photos.slice(0,3).map((u,f)=>e.jsx("img",{src:u,alt:`Photo ${f+1}`,className:"w-16 h-16 object-cover rounded-lg"},f))})]})},i.id))}),o.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{onClick:a,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvÃ©"})})]})})}function tt({bidId:n,bidderName:b,isOpen:p,onClose:a}){const{user:h}=ae(),{toast:o}=pe(),N=we(),[r,i]=C.useState(null),[u,f]=C.useState(""),M=as({mutationFn:async x=>(await ke("POST","/api/bids/respond",x)).json(),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/missions"]});const x=r==="accept"?"acceptÃ©e":r==="reject"?"dÃ©clinÃ©e":"en nÃ©gociation";o({title:"RÃ©ponse envoyÃ©e !",description:`Votre rÃ©ponse (${x}) a Ã©tÃ© envoyÃ©e au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre rÃ©ponse "${x}" a bien Ã©tÃ© envoyÃ©e Ã  ${b}. Un email de confirmation lui a Ã©tÃ© envoyÃ©.`)},500),a(),i(null),f("")},onError:x=>{o({title:"Erreur",description:x.message||"Une erreur est survenue",variant:"destructive"})}}),P=x=>{if(x.preventDefault(),!r){o({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(r==="negotiate"&&!u.trim()){o({title:"Message requis",description:"Veuillez ajouter un message pour nÃ©gocier",variant:"destructive"});return}M.mutate({bidId:n,status:r,message:u.trim()||null,clientResponse:r})},q=x=>{switch(x){case"accept":return`Bonjour ${b},

Nous avons le plaisir de vous informer que votre offre a Ã©tÃ© retenue pour ce projet. Nous allons procÃ©der Ã  la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${b},

Nous vous remercions pour votre offre. Malheureusement, nous avons dÃ©cidÃ© de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${b},

Votre offre nous intÃ©resse. Cependant, nous aimerions discuter de certains points :

- 
- 

ÃŠtes-vous ouvert Ã  la nÃ©gociation ?

Cordialement`}},D=x=>{i(x),f(q(x))};return e.jsx(ze,{open:p,onOpenChange:a,children:e.jsxs($e,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsxs(Ee,{children:[e.jsxs(Fe,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(te,{className:"w-6 h-6 text-blue-500"}),"RÃ©pondre Ã  l'offre de ",b]}),e.jsx(Le,{children:"Choisissez comment vous souhaitez rÃ©pondre Ã  cette offre"})]}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre rÃ©ponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>D("accept"),className:`p-4 rounded-xl border-2 transition-all ${r==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(Re,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>D("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${r==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(te,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"NÃ©gocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>D("reject"),className:`p-4 rounded-xl border-2 transition-all ${r==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(ms,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"DÃ©cliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message Ã  ",b]}),e.jsx(U,{id:"message",value:u,onChange:x=>f(x.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(k,{type:"button",variant:"outline",onClick:a,className:"flex-1",disabled:M.isPending,children:"Annuler"}),e.jsx(k,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!r||M.isPending,children:M.isPending?"Envoi...":"Envoyer la rÃ©ponse"})]})]})]})})}function $t(){console.log("ðŸ” MissionDetailPage - DÃ©marrage du composant");const{user:n}=ae(),b=rs(),[,p]=is(),a=b.id;console.log("ðŸ” MissionDetailPage - Params reÃ§us:",{missionId:a,user:n?.name});const[h,o]=C.useState("overview"),[N,r]=C.useState(null),[i,u]=C.useState(""),[f,M]=C.useState(null),[P,q]=C.useState(""),[D,x]=C.useState(!1),[m,t]=C.useState(!1),{data:s,isLoading:g,error:v}=De({queryKey:["mission-detail",a],queryFn:async()=>{if(console.log("ðŸ” Chargement mission avec mappers ID:",a),!a||a==="undefined"||a==="null")throw new Error("ID de mission invalide");try{const c=await ls.feed.getMissionById(a);return console.log("âœ… Mission normalisÃ©e chargÃ©e:",c.title),c}catch(c){throw console.error("âŒ Erreur lors du chargement de la mission:",c),c}},enabled:!!a,retry:1,retryDelay:2e3,staleTime:3e4});C.useEffect(()=>{if(s){document.title=`${s.title} - SwipDEAL`;const c=document.querySelector('meta[name="description"]');c&&c.setAttribute("content",`Mission: ${s.title} - Budget: ${s.budgetDisplay} - ${s.description.slice(0,150)}...`)}},[s]);const K=()=>{if(!s||!n)return"overview";const l=[...s.bids||[]].sort((j,L)=>j.amount-L.amount),d=s.teamRequirements&&s.teamRequirements.length>0;return n.type==="client"&&s.clientName===n.name&&l.length>0?"bids":d&&n.type==="provider"&&s.clientName!==n.name?"team":"overview"};C.useEffect(()=>{if(console.log("ðŸ”„ useEffect - Mission ou user changÃ©:",{missionId:s?.id,userId:n?.id,missionExists:!!s}),s){const c=K();console.log("ðŸ“Š Onglet par dÃ©faut calculÃ©:",c),o(c),r(null),u(""),M(null),q(""),x(!1),t(!1)}},[s?.id,n?.id,s,n]);const he=c=>{o(c),console.log(`ðŸ“Š Navigation vers l'onglet: ${c} pour mission ${s?.id}`)},ge=c=>{const l=parseFloat(c);return Array.from({length:5},(d,j)=>e.jsx(B,{className:`w-4 h-4 ${j<Math.floor(l)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`},j))};if(console.log("ðŸ” MissionDetailPage - Ã‰tat du rendu:",{isLoading:g,hasError:!!v,hasMission:!!s,missionId:s?.id}),g)return console.log("â³ MissionDetailPage - Affichage du loading"),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Chargement de la mission"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"RÃ©cupÃ©ration des dÃ©tails..."})]})]})})})});if(v||!s)return console.error("âŒ MissionDetailPage - Erreur ou mission manquante:",{error:v instanceof Error?v.message:v,mission:s,missionId:a,hasError:!!v,hasMission:!!s,stack:v instanceof Error?v.stack:void 0}),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(fs,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"Mission introuvable"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:v instanceof Error?v.message:"Cette mission n'existe plus ou a Ã©tÃ© supprimÃ©e."}),!1,e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(k,{onClick:()=>window.location.reload(),variant:"outline",children:"Recharger"}),e.jsxs(k,{onClick:()=>p("/provider-profile"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Retour au marketplace"]})]})]})})});console.log("âœ… MissionDetailPage - Mission chargÃ©e, prÃ©paration du rendu:",s.title);const re=s?ns(s.category):null,E=s?.bids?[...s.bids].sort((c,l)=>c.amount-l.amount):[],F=s?.teamRequirements&&Array.isArray(s.teamRequirements)&&s.teamRequirements.length>0;return console.log("ðŸ” Team Mission Check:",{hasTeamRequirements:!!s?.teamRequirements,teamRequirementsLength:s?.teamRequirements?.length,isTeamMission:F}),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(k,{onClick:()=>p("/provider-profile"),variant:"ghost",className:"flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-800","data-testid":"button-back-marketplace",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Retour au marketplace"]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),E.length," candidature",E.length!==1?"s":""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),s.createdAt?le(s.createdAt):"Date non spÃ©cifiÃ©e"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-3","data-testid":"text-mission-title",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1","data-testid":"text-client-name",children:[e.jsx(ue,{className:"w-4 h-4"}),s.clientName]}),e.jsxs("span",{className:"flex items-center gap-1","data-testid":"text-budget",children:[e.jsx(Z,{className:"w-4 h-4"}),s.budgetDisplay]}),re&&e.jsx(_,{variant:"secondary",className:"text-xs","data-testid":"badge-category",children:re.name})]})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs(Ie,{value:h,onValueChange:he,className:"w-full",children:[e.jsxs(Be,{className:`w-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-2 mb-8 ${F?"grid":"flex"} gap-3`,style:F&&s.teamRequirements?{gridTemplateColumns:`repeat(${2+s.teamRequirements.length}, 1fr)`}:{},children:[e.jsxs(J,{value:"overview",className:"flex items-center justify-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 dark:data-[state=active]:bg-blue-900/30 dark:data-[state=active]:text-blue-400 text-sm px-4 py-3 font-medium","data-testid":"tab-overview",children:[e.jsx(vs,{className:"w-4 h-4"}),e.jsx("span",{children:"DÃ©tails"})]}),F&&s.teamRequirements?.map((c,l)=>e.jsxs(J,{value:`specialty-${l}`,className:"flex items-center justify-center gap-2 data-[state=active]:bg-purple-50 data-[state=active]:text-purple-600 dark:data-[state=active]:bg-purple-900/30 dark:data-[state=active]:text-purple-400 text-sm px-4 py-3 font-medium","data-testid":`tab-specialty-${l}`,children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate max-w-[120px]",title:c.profession,children:c.profession}),c.is_lead_role&&e.jsx(B,{className:"w-3 h-3 text-yellow-500"})]},l)),e.jsxs(J,{value:"bids",className:"flex items-center justify-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 dark:data-[state=active]:bg-blue-900/30 dark:data-[state=active]:text-blue-400 text-sm px-4 py-3 font-medium min-w-[120px]","data-testid":"tab-bids",children:[e.jsx(Ns,{className:"w-4 h-4"}),e.jsx("span",{children:"Offres"}),e.jsx(_,{variant:"secondary",className:"text-xs ml-1",children:E.length})]})]}),e.jsxs(H,{value:"overview",className:"space-y-6","data-testid":"content-overview",children:[e.jsxs(y,{children:[e.jsx(T,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-blue-600"}),"Description du projet"]})}),e.jsx(w,{children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed","data-testid":"text-description",children:s.description})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Budget"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400","data-testid":"text-budget-amount",children:s.budgetDisplay})]})]})})}),e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(We,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Localisation"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white","data-testid":"text-location",children:s.location||"Non spÃ©cifiÃ©"})]})]})})}),e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Candidatures"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400","data-testid":"text-bids-count",children:E.length})]})]})})})]}),n&&n.type==="provider"&&s.clientName!==n.name&&e.jsx(Zs,{mission:s,user:n,sortedBids:E,showAIAnalyzer:m,setShowAIAnalyzer:t,showBidForm:D,setShowBidForm:x}),n&&n.type==="provider"&&s.clientName===n.name&&e.jsx(y,{className:"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(ve,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Ceci est votre mission"})]})})})]}),e.jsx(H,{value:"bids",className:"space-y-6","data-testid":"content-bids",children:E.length===0?e.jsx(y,{children:e.jsxs(w,{className:"p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(I,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Aucune candidature"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Cette mission n'a pas encore reÃ§u d'offres de prestataires"})]})}):e.jsx("div",{className:"space-y-6",children:E.map((c,l)=>e.jsx(y,{className:"hover:shadow-md transition-all duration-200","data-testid":`card-bid-${c.id}`,children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:c.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors",onClick:()=>{r(c.providerId),u(c.providerName)},"data-testid":`text-provider-${c.id}`,children:c.providerName}),l===0&&E.length>1&&e.jsx(_,{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:"Meilleure offre"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center",children:ge("5.0")}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"5.0/5"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mb-1","data-testid":`text-bid-amount-${c.id}`,children:typeof c.amount=="string"?`${c.amount}â‚¬`:cs(c.amount.toString())}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(xe,{className:"w-4 h-4"}),c.timeline_days?`${c.timeline_days} jours`:"Non spÃ©cifiÃ©"]})]})]}),c.message&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed","data-testid":`text-bid-message-${c.id}`,children:c.message})}),n&&s.clientName===n.name&&e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(k,{onClick:()=>{M(c.id),q(c.providerName)},variant:"outline",className:"flex items-center gap-2","data-testid":`button-contact-${c.id}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Contacter"]}),e.jsxs(k,{className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2","data-testid":`button-accept-${c.id}`,children:[e.jsx(ve,{className:"w-4 h-4"}),"Accepter l'offre"]})]})]})},c.id))})}),F&&s.teamRequirements?.map((c,l)=>e.jsx(H,{value:`specialty-${l}`,className:"space-y-6","data-testid":`content-specialty-${l}`,children:e.jsxs(y,{className:"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border-purple-200 dark:border-purple-700",children:[e.jsxs(T,{children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs(A,{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-14 h-14 bg-purple-600 dark:bg-purple-500 rounded-xl flex items-center justify-center text-white font-bold text-2xl shadow-lg",children:l+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:c.profession}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.is_lead_role&&e.jsxs(_,{className:"bg-purple-600 text-white",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),"Lead de l'Ã©quipe"]}),e.jsx(_,{variant:c.importance==="high"?"destructive":c.importance==="medium"?"default":"secondary",children:c.importance==="high"?"ðŸ”¥ Prioritaire":c.importance==="medium"?"ðŸ“Œ Important":"ðŸ’¡ Optionnel"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-purple-200 dark:border-purple-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[c.estimated_budget.toLocaleString(),"â‚¬"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Budget allouÃ©"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[c.estimated_days,"j"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"DurÃ©e estimÃ©e"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[c.min_experience,"+"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"AnnÃ©es d'exp."})]})]})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-purple-600"}),"Description du rÃ´le"]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:c.description})]}),c.required_skills&&c.required_skills.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-600"}),"CompÃ©tences requises"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.required_skills.map((d,j)=>e.jsx(_,{variant:"outline",className:"bg-white dark:bg-gray-800 text-base py-2 px-3",children:d},j))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-purple-600"}),"DÃ©tails de la mission"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(y,{className:"bg-white dark:bg-gray-800",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Budget"}),e.jsxs("p",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:[c.estimated_budget,"â‚¬"]})]})]})})}),e.jsx(y,{className:"bg-white dark:bg-gray-800",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(xe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"DurÃ©e"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:[c.estimated_days," jours"]})]})]})})}),e.jsx(y,{className:"bg-white dark:bg-gray-800",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(ee,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"ExpÃ©rience min."}),e.jsxs("p",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:[c.min_experience," an",c.min_experience>1?"s":""]})]})]})})})]})]}),n&&n.type==="provider"&&s.clientName!==n.name&&e.jsxs("div",{className:"pt-4 border-t border-purple-200 dark:border-purple-700",children:[e.jsxs(k,{className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-semibold text-lg py-6",onClick:()=>{console.log("Candidature pour le rÃ´le:",c.profession),x(!0)},"data-testid":`button-apply-specialty-${l}`,children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"Postuler pour ce rÃ´le"]}),e.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400 mt-3",children:["ðŸ’° ",c.estimated_budget,"â‚¬ â€¢ â±ï¸ ",c.estimated_days," jours â€¢ ðŸŽ¯ ",c.min_experience," an",c.min_experience>1?"s":""," d'expÃ©rience"]})]}),n&&s.clientName===n.name&&e.jsx("div",{className:"pt-4 border-t border-purple-200 dark:border-purple-700",children:e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:[e.jsx(ee,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-purple-700 dark:text-purple-300",children:"Vous avez crÃ©Ã© cette mission"}),e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:`Les candidatures pour ce rÃ´le apparaÃ®tront dans l'onglet "Offres"`})]})]})}),s.teamRequirements&&s.teamRequirements.length>1&&e.jsxs("div",{className:"pt-4 border-t border-purple-200 dark:border-purple-700",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Autres rÃ´les de l'Ã©quipe (",s.teamRequirements.length-1,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:s.teamRequirements.map((d,j)=>j!==l&&e.jsxs("button",{onClick:()=>o(`specialty-${j}`),className:"flex items-center gap-2 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-purple-400 hover:shadow-md transition-all text-left","data-testid":`button-other-specialty-${j}`,children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center text-purple-600 dark:text-purple-400 font-bold text-sm",children:j+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:d.profession}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[d.estimated_budget,"â‚¬ â€¢ ",d.estimated_days,"j"]})]}),d.is_lead_role&&e.jsx(B,{className:"w-4 h-4 text-yellow-500 shrink-0"})]},j))})]})]})]})},l))]})}),e.jsx(st,{providerId:N,providerName:i,isOpen:!!N,onClose:()=>{r(null),u("")}}),e.jsx(tt,{bidId:f,bidderName:P,isOpen:!!f,onClose:()=>{M(null),q("")}}),D&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(Oe,{missionId:a,onSuccess:()=>{x(!1),window.location.reload()}})})}),m&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Analyse IA de la mission"}),e.jsx(k,{onClick:()=>t(!1),variant:"ghost",size:"sm",children:"âœ•"})]}),e.jsx(Je,{missionTitle:s.title,missionDescription:s.description,missionBudget:s.budget||0,missionCategory:s.category,currentBid:{price:0,timeline:"Ã€ dÃ©finir",proposal:""},providerProfile:{rating:5,completedProjects:0,skills:[],portfolio:[]},onRecommendationApplied:()=>{t(!1),x(!0)}})]})})})]})}export{$t as default};
