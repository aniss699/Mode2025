import{j as e,r as M}from"./ui-D9tbKjPW.js";import{u as re}from"./useQuery-BYK6sVPC.js";import{C as F,b as G,U as W,c as H,d as ne,e as le,f as ce,Z as ie,P as oe,T as de,B as $,g as me,u as ue,L as _,I as he}from"./index-BhnURYFB.js";import{d as xe}from"./services-bOyojbaX.js";import{B as k}from"./badge-Df8SQPIc.js";import{c as J}from"./categories-CJOmrs8V.js";import{E as ge}from"./euro-DoF-MBce.js";import{M as fe}from"./map-pin-D4S-L_zk.js";import{T as ee}from"./trending-up-Bor80aLq.js";import{C as pe}from"./clock-q3-gwJG4.js";import{t as y,c as be,e as je,d as ye,g as Z,a as Ne,b as ve,m as Q,f as E}from"./en-US-oEpl4HuW.js";import{f as we}from"./fr-Qfl_UVRO.js";import{R as Me}from"./refresh-cw-BFNN9z1y.js";import{T as Ce,C as Se}from"./triangle-alert-Qjv6XiAY.js";import{S as V,a as X,b as U,c as K,d as w}from"./select-Dwtk5ZDs.js";import{B as De}from"./brain-Dw80nMnq.js";import{S as Le}from"./star-BdKw_erC.js";import"./vendor-D3F3s8fL.js";import"./index-DLM4OUNl.js";import"./chevron-up-CiItJY8e.js";function q(t,o){const m=y(t),u=y(o),i=m.getTime()-u.getTime();return i<0?-1:i>0?1:i}function Te(t){return be(t,Date.now())}function ke(t){return o=>{const u=(t?Math[t]:Math.trunc)(o);return u===0?0:u}}function Re(t,o){return+y(t)-+y(o)}function Pe(t){const o=y(t);return o.setHours(23,59,59,999),o}function Ae(t){const o=y(t);return+Pe(o)==+je(o)}function Ie(t,o){const m=y(t),u=y(o),i=q(m,u),j=Math.abs(ye(m,u));let p;if(j<1)p=0;else{m.getMonth()===1&&m.getDate()>27&&m.setDate(30),m.setMonth(m.getMonth()-i*j);let d=q(m,u)===-i;Ae(y(t))&&j===1&&q(t,u)===1&&(d=!1),p=i*(j-Number(d))}return p===0?0:p}function Be(t,o,m){const u=Re(t,o)/1e3;return ke(m?.roundingMethod)(u)}function ze(t,o,m){const u=Ne(),i=m?.locale??u.locale??ve,j=2520,p=q(t,o);if(isNaN(p))throw new RangeError("Invalid time value");const d=Object.assign({},m,{addSuffix:m?.addSuffix,comparison:p});let N,S;p>0?(N=y(o),S=y(t)):(N=y(t),S=y(o));const h=Be(S,N),A=(Z(S)-Z(N))/1e3,b=Math.round((h-A)/60);let x;if(b<2)return m?.includeSeconds?h<5?i.formatDistance("lessThanXSeconds",5,d):h<10?i.formatDistance("lessThanXSeconds",10,d):h<20?i.formatDistance("lessThanXSeconds",20,d):h<40?i.formatDistance("halfAMinute",0,d):h<60?i.formatDistance("lessThanXMinutes",1,d):i.formatDistance("xMinutes",1,d):b===0?i.formatDistance("lessThanXMinutes",1,d):i.formatDistance("xMinutes",b,d);if(b<45)return i.formatDistance("xMinutes",b,d);if(b<90)return i.formatDistance("aboutXHours",1,d);if(b<Q){const g=Math.round(b/60);return i.formatDistance("aboutXHours",g,d)}else{if(b<j)return i.formatDistance("xDays",1,d);if(b<E){const g=Math.round(b/Q);return i.formatDistance("xDays",g,d)}else if(b<E*2)return x=Math.round(b/E),i.formatDistance("aboutXMonths",x,d)}if(x=Ie(S,N),x<12){const g=Math.round(b/E);return i.formatDistance("xMonths",g,d)}else{const g=x%12,C=Math.trunc(x/12);return g<3?i.formatDistance("aboutXYears",C,d):g<9?i.formatDistance("overXYears",C,d):i.formatDistance("almostXYears",C+1,d)}}function _e(t,o){return ze(t,Te(t),o)}function Ee({mission:t,onClick:o}){const m=J.find(j=>j.id===t.category),u=t.bids.length>0?t.bids.reduce((j,p)=>j+p.amount,0)/t.bids.length:0,i=t.is_team_mission||t.isTeamMode;return e.jsxs(F,{className:`cursor-pointer hover:shadow-lg transition-shadow ${i?"border-l-4 border-l-purple-500":"border-l-4 border-l-blue-500"} hover:scale-[1.02] bg-white h-fit`,onClick:o,children:[e.jsx(G,{className:"pb-2 pt-3",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("h3",{className:"font-semibold text-base line-clamp-2 flex-1 leading-tight",children:t.title}),i&&e.jsxs(k,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300 shrink-0",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"√âquipe"]})]}),e.jsx(k,{variant:"secondary",className:"shrink-0 text-xs px-2 py-1",children:m?.name||t.category}),t.bids.length>0&&e.jsxs(k,{variant:"outline",className:"text-xs px-2 py-1",children:["üî• ",t.bids.length]})]})}),e.jsxs(H,{className:"py-1",children:[e.jsx("p",{className:"text-gray-600 line-clamp-2 mb-3 text-sm leading-relaxed",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ge,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"font-medium truncate",children:t.budgetDisplay})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(W,{className:"w-3 h-3 text-purple-600"}),e.jsxs("span",{className:"truncate",children:[t.bids.length," offre",t.bids.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(fe,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"truncate",children:t.location||"Non sp√©cifi√©"})]}),u>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ee,{className:"w-3 h-3 text-orange-600"}),e.jsxs("span",{className:"font-medium truncate",children:[Math.round(u),"‚Ç¨ moy"]})]})]})]}),e.jsxs(ne,{className:"pt-2 pb-3 border-t bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i&&t.team_size&&e.jsxs(k,{variant:"outline",className:"bg-purple-50 text-purple-700",children:[t.team_size," postes"]}),t.bids.length>0&&e.jsxs(k,{variant:"outline",children:[t.bids.length," offre",t.bids.length>1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 text-xs",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:_e(new Date(t.createdAt),{addSuffix:!0,locale:we})})]}),e.jsx("div",{className:"text-xs font-medium text-primary truncate ml-2",children:t.clientName})]})]})}function Fe({isLoading:t=!1,hasError:o=!1,isFallbackMode:m=!1,errorMessage:u,onRetry:i,className:j=""}){if(!t&&!o&&!m)return null;const d=t?{icon:Me,color:"blue",title:"Chargement en cours...",message:"R√©cup√©ration des donn√©es",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-800",iconClass:"text-blue-500 animate-spin"}:m?{icon:Ce,color:"orange",title:"Mode d√©grad√©",message:"Le service fonctionne avec des fonctionnalit√©s limit√©es",bgClass:"bg-orange-50 border-orange-200",textClass:"text-orange-800",iconClass:"text-orange-500"}:o?{icon:Se,color:"red",title:"Probl√®me technique",message:u||"Une erreur est survenue",bgClass:"bg-red-50 border-red-200",textClass:"text-red-800",iconClass:"text-red-500"}:{icon:le,color:"green",title:"Service op√©rationnel",message:"Tout fonctionne normalement",bgClass:"bg-green-50 border-green-200",textClass:"text-green-800",iconClass:"text-green-500"},N=d.icon;return e.jsx("div",{className:`border rounded-lg p-4 ${d.bgClass} ${j}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:`w-5 h-5 ${d.iconClass}`}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${d.textClass}`,children:d.title}),e.jsx("p",{className:`text-sm ${d.textClass} opacity-80`,children:d.message})]})]}),i&&(o||m)&&e.jsx("button",{onClick:i,className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${d.color==="orange"?"bg-orange-200 hover:bg-orange-300 text-orange-800":"bg-red-200 hover:bg-red-300 text-red-800"}`,children:"R√©essayer"})]})})}function $e({providerProfile:t,missions:o,onMissionRecommended:m}){const[u,i]=M.useState([]),[j,p]=M.useState(!1),[d,N]=M.useState({minMatchScore:70,maxCompetition:"high",minWinProbability:40}),S=async()=>{p(!0),await new Promise(s=>setTimeout(s,1500));const c=o.map(s=>{const r=h(s,t),l=A(s,t),B=b(s,t),P=x(s,t),O=r*.35+l*.25+B*.15+P*.25,T=g(s),Y=C(O,T,t.rating,t.completedProjects),se=L(s,T,t),te=D(s),ae=v(s,t,{skillsMatch:r,locationMatch:B,competitionLevel:T,winProbability:Y});return{missionId:s.id,title:s.title,description:s.description,budget:s.budget,matchScore:O,reasonsToApply:ae,competitionLevel:T,winProbability:Y,recommendedBidPrice:se,skillsMatch:r,experienceMatch:l,locationMatch:B,urgency:te,clientProfile:{name:s.clientName,rating:4.2+Math.random()*.8,projectsPosted:Math.floor(Math.random()*20)+1,avgBudget:s.budget*(.8+Math.random()*.4)}}}).sort((s,r)=>r.matchScore-s.matchScore).slice(0,10);i(c),p(!1)},h=(a,c)=>{const s=I(a),r=c.skills.map(P=>P.toLowerCase());let l=0,B=s.length;return s.forEach(P=>{r.some(T=>T.includes(P)||P.includes(T)||R(P,T)>.7)&&l++}),Math.min(100,l/Math.max(B,1)*100)},A=(a,c)=>{let s=0;return c.completedProjects>=50?s+=40:c.completedProjects>=20?s+=30:c.completedProjects>=5?s+=20:s+=10,c.categories.includes(a.category)&&(s+=30),s+=c.rating/5*30,Math.min(100,s)},b=(a,c)=>{if(!a.location||!c.location)return 70;const s=a.location.toLowerCase(),r=c.location.toLowerCase();if(s===r)return 100;if(s.includes(r)||r.includes(s))return 85;const l=Math.random()*500;return l<50?90:l<100?75:l<200?60:40},x=(a,c)=>{const s=a.budget,r=c.hourlyRate,l=s/r;return l>=20&&l<=100?100:l>=10&&l<=150?80:l>=5&&l<=200?60:40},g=a=>{const c=a.bids?.length||0,s=Math.floor((Date.now()-new Date(a.createdAt).getTime())/(1e3*60*60*24));return c>10||s>7?"high":c>5||s>3?"medium":"low"},C=(a,c,s,r)=>{let l=a;return c==="low"?l*=1.3:c==="high"&&(l*=.7),l+=s/5*10,l+=Math.min(15,r*.2),Math.min(95,Math.max(5,l))},L=(a,c,s)=>{let l=a.budget;return c==="high"?l*=.85:c==="low"?l*=.95:l*=.9,s.rating>=4.5&&s.completedMissions>=20&&(l*=1.05),Math.round(l)},D=a=>{if(["urgent","asap","rapidement","imm√©diat","express"].some(l=>a.title.toLowerCase().includes(l)||a.description.toLowerCase().includes(l)))return"high";const r=Math.floor((Date.now()-new Date(a.createdAt).getTime())/(1e3*60*60*24));return r<=1?"high":r<=3?"medium":"low"},v=(a,c,s)=>{const r=[];return s.skillsMatch>=80&&r.push("Parfaite correspondance avec vos comp√©tences"),s.competitionLevel==="low"&&r.push("Faible concurrence - grande chance de succ√®s"),s.winProbability>=70&&r.push(`${Math.round(s.winProbability)}% de probabilit√© de gagner`),a.budget>=c.hourlyRate*20&&r.push("Budget attractif pour ce type de projet"),s.locationMatch>=90&&r.push("Client dans votre zone g√©ographique"),r.slice(0,3)},I=a=>{const c=(a.title+" "+a.description+" "+a.category).toLowerCase(),s=["le","la","les","un","une","des","et","ou","mais","donc"];return c.split(/[\s,;.!?]+/).filter(r=>r.length>3&&!s.includes(r)).slice(0,10)},R=(a,c)=>{const s=a.length>c.length?a:c,r=a.length>c.length?c:a;if(s.length===0)return 1;const l=n(s,r);return(s.length-l)/s.length},n=(a,c)=>{const s=[];for(let r=0;r<=c.length;r++)s[r]=[r];for(let r=0;r<=a.length;r++)s[0][r]=r;for(let r=1;r<=c.length;r++)for(let l=1;l<=a.length;l++)c.charAt(r-1)===a.charAt(l-1)?s[r][l]=s[r-1][l-1]:s[r][l]=Math.min(s[r-1][l-1]+1,s[r][l-1]+1,s[r-1][l]+1);return s[c.length][a.length]},f=a=>{switch(a){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},z=a=>{switch(a){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return M.useEffect(()=>{o.length>0&&S()},[o,t]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(F,{children:e.jsx(G,{children:e.jsxs(ce,{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-6 h-6 text-purple-600"}),e.jsx("span",{children:"Moteur de Matching IA"}),e.jsxs(k,{variant:"secondary",className:"bg-purple-100 text-purple-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Algorithm v2.0"]})]})})}),j?e.jsx(F,{children:e.jsxs(H,{className:"py-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-600",children:["Analyse de ",o.length," missions avec notre IA..."]})]})}):e.jsx("div",{className:"space-y-4",children:u.map((a,c)=>e.jsx(F,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.title}),e.jsxs(k,{className:`px-2 py-1 text-xs ${f(a.competitionLevel)}`,children:["Concurrence ",a.competitionLevel]}),e.jsx(k,{className:`px-2 py-1 text-xs ${z(a.urgency)}`,children:a.urgency==="high"?"Urgent":a.urgency==="medium"?"Normal":"Pas press√©"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[a.budget,"‚Ç¨"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Prix sugg√©r√©: ",a.recommendedBidPrice,"‚Ç¨"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Score de correspondance"}),e.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[Math.round(a.matchScore),"%"]})]}),e.jsx(oe,{value:a.matchScore,className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-gray-600",children:[e.jsxs("div",{children:["Comp√©tences: ",Math.round(a.skillsMatch),"%"]}),e.jsxs("div",{children:["Exp√©rience: ",Math.round(a.experienceMatch),"%"]}),e.jsxs("div",{children:["Localisation: ",Math.round(a.locationMatch),"%"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(de,{className:"w-4 h-4 mr-1 text-blue-600"}),"Pourquoi postuler"]}),e.jsx("ul",{className:"space-y-1",children:a.reasonsToApply.map((s,r)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"‚Ä¢"}),s]},r))})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),a.clientProfile.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1 text-yellow-500"}),a.clientProfile.rating.toFixed(1)]}),e.jsxs("div",{children:[a.clientProfile.projectsPosted," projets post√©s"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"font-medium",children:[Math.round(a.winProbability),"% de succ√®s"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Rang #",c+1," sur ",u.length]}),e.jsx($,{onClick:()=>m?.(a),className:"bg-purple-600 hover:bg-purple-700",children:"Voir la mission"})]})]})},a.missionId))})]})}function cs(){const{user:t}=me(),[,o]=ue(),[m,u]=M.useState(!1),[i,j]=M.useState(!1),[p,d]=M.useState(0),[N,S]=M.useState(0),[h,A]=M.useState({category:"all",budget:"all",location:"",sort:"newest",teamOnly:!1}),{data:b,isLoading:x,error:g,refetch:C}=re({queryKey:["/api/missions"],queryFn:async()=>{console.log("üîÑ D√©but requ√™te missions API avec mappers...");try{const n=await xe.feed.getMissions();return console.log("‚úÖ Missions normalis√©es r√©cup√©r√©es:",n.missions.length),n}catch(n){return console.error("‚ùå Erreur r√©seau:",n),{missions:[],metadata:{total:0,has_errors:!0,error_message:`Erreur r√©seau: ${n instanceof Error?n.message:"Unknown error"}`,fallback_mode:!0}}}},refetchInterval:12e4,retry:(n,f)=>(console.log(`üîÑ Tentative ${n+1}/3 apr√®s erreur:`,f),n<2),retryDelay:n=>{const f=Math.min(1e3*Math.pow(2,n),1e4);return console.log(`‚è≥ Retry dans ${f}ms`),f},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,meta:{errorPolicy:"soft"}}),L=b?.missions||[],D=b?.metadata||{total:0},v=D.fallback_mode||!1;console.log("üè™ Marketplace - √âtat actuel:",{missionsCount:L.length,isLoading:x,hasError:!!g,errorMessage:g?.message}),M.useEffect(()=>{if(g&&!x&&p<3&&Date.now()-N>5e3){const a=Math.min(2e3*Math.pow(2,p),1e4);console.log(`üîÑ Retry automatique #${p+1} dans ${a}ms`);const c=setTimeout(()=>{console.log(`üîÑ Ex√©cution retry automatique #${p+1}`),d(s=>s+1),S(Date.now()),C()},a);return()=>clearTimeout(c)}},[g,x,p,N,C]),M.useEffect(()=>{!g&&!x&&L.length>0&&d(0)},[g,x,L.length]);const I=L.filter(n=>{if(h.category&&h.category!=="all"&&n.category!==h.category||h.location&&!n.location?.toLowerCase().includes(h.location.toLowerCase())||h.teamOnly&&!n.is_team_mission&&!n.isTeamMode)return!1;if(h.budget&&h.budget!=="all"){const f=n.budget;switch(h.budget){case"0-500":return f>=0&&f<=500;case"500-2000":return f>500&&f<=2e3;case"2000-5000":return f>2e3&&f<=5e3;case"5000+":return f>5e3;default:return!0}}return!0}).sort((n,f)=>{switch(h.sort){case"newest":return new Date(f.createdAt).getTime()-new Date(n.createdAt).getTime();case"budget-high":return f.budget-n.budget;case"budget-low":return n.budget-f.budget;case"bids":return f.bids.length-n.bids.length;default:return 0}}),R=(n,f)=>{A(z=>({...z,[n]:f}))};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 sm:mb-4",children:"Marketplace des Projets"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 mb-4",children:"D√©couvrez et soumissionnez sur les projets disponibles"}),e.jsx(Fe,{isLoading:x,hasError:!!g&&!v,isFallbackMode:v,errorMessage:D?.error_message,onRetry:()=>{console.log("üîÑ Retry depuis la banni√®re"),C()},className:"mb-4"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs($,{onClick:()=>j(!i),variant:"outline",className:"mb-4 gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),"Filtres",i?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filtres de recherche"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"category-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Cat√©gorie"}),e.jsxs(V,{value:h.category,onValueChange:n=>R("category",n),children:[e.jsx(X,{className:"h-8",children:e.jsx(U,{placeholder:"Toutes les cat√©gories"})}),e.jsxs(K,{children:[e.jsx(w,{value:"all",children:"Toutes les cat√©gories"}),J.map(n=>e.jsx(w,{value:n.id,children:n.name},n.id))]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"budget-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Budget"}),e.jsxs(V,{value:h.budget,onValueChange:n=>R("budget",n),children:[e.jsx(X,{className:"h-8",children:e.jsx(U,{placeholder:"Tous les budgets"})}),e.jsxs(K,{children:[e.jsx(w,{value:"all",children:"Tous les budgets"}),e.jsx(w,{value:"0-500",children:"0 - 500‚Ç¨"}),e.jsx(w,{value:"500-2000",children:"500‚Ç¨ - 2 000‚Ç¨"}),e.jsx(w,{value:"2000-5000",children:"2 000‚Ç¨ - 5 000‚Ç¨"}),e.jsx(w,{value:"5000+",children:"5 000‚Ç¨+"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"location-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Localisation"}),e.jsx(he,{id:"location-filter",type:"text",placeholder:"Ville, r√©gion...",value:h.location,onChange:n=>R("location",n.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{id:"team-filter",type:"checkbox",checked:h.teamOnly,onChange:n=>R("teamOnly",n.target.checked),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(_,{htmlFor:"team-filter",className:"text-xs font-medium text-gray-600 cursor-pointer",children:"Missions √©quipe uniquement"})]}),e.jsx($,{onClick:()=>A({category:"all",budget:"all",location:"",sort:"newest",teamOnly:!1}),variant:"outline",className:"h-8 w-full",size:"sm",children:"R√©initialiser"})]})]})]})]}),e.jsxs("div",{className:"lg:w-3/4 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-4 sm:mb-0",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Toutes les missions (",I.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Chargement..."]}),!x&&!g&&!v&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Service actif"]}),v&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"Mode d√©grad√©"]}),D?.total!==void 0&&e.jsxs("div",{className:"text-sm text-gray-500",children:[D.total," total",D.has_errors&&" (avec erreurs)"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[t?.type==="provider"&&e.jsx($,{onClick:()=>u(!m),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 w-full sm:w-auto",children:"ü§ñ Matching IA"}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"Trier par:"}),e.jsxs(V,{value:h.sort,onValueChange:n=>R("sort",n),children:[e.jsx(X,{className:"w-full sm:w-40",children:e.jsx(U,{})}),e.jsxs(K,{children:[e.jsx(w,{value:"newest",children:"Plus r√©cent"}),e.jsx(w,{value:"budget-high",children:"Budget d√©croissant"}),e.jsx(w,{value:"budget-low",children:"Budget croissant"}),e.jsx(w,{value:"bids",children:"Nombre d'offres"})]})]})]})]})]}),m&&t?.type==="provider"&&e.jsx("div",{className:"mb-8",children:e.jsx($e,{providerProfile:{id:t.id,skills:["React","Node.js","TypeScript","Python"],location:"Paris",rating:4.7,completedProjects:28,portfolio:[],hourlyRate:65,categories:["web-development","mobile-development"]},missions:I,onMissionRecommended:n=>{o(`/missions/${n.missionId}`),u(!1)}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[x&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Chargement des missions..."})]}),(g||v)&&!x&&e.jsx("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-2xl p-8 mx-auto max-w-2xl",children:[e.jsx("div",{className:"text-orange-500 mb-4",children:v?"‚ö†Ô∏è":"‚ùå"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:v?"Mode d√©grad√© activ√©":"Probl√®me de chargement"}),e.jsx("p",{className:"text-gray-700 text-base mb-4",children:v?"Les missions ne peuvent pas √™tre charg√©es normalement. Le syst√®me fonctionne en mode d√©grad√©.":"Impossible de charger les missions pour le moment."}),D.error_message&&e.jsxs("div",{className:"bg-white/70 rounded-lg p-4 mb-4 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"D√©tail:"})," ",D.error_message]}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-6",children:[e.jsx("button",{onClick:()=>{console.log("üîÑ Retry manuel d√©clench√©"),C()},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"üîÑ R√©essayer"}),e.jsx("button",{onClick:()=>{console.log("üè† Retour accueil"),window.location.href="/"},className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"üè† Retour accueil"})]}),e.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[e.jsxs("p",{className:"mb-2",children:["üí° ",e.jsx("strong",{children:"Suggestions:"})]}),e.jsxs("ul",{className:"text-left space-y-1 max-w-md mx-auto",children:[e.jsx("li",{children:"‚Ä¢ V√©rifiez votre connexion internet"}),e.jsx("li",{children:"‚Ä¢ Essayez de recharger dans quelques minutes"}),e.jsx("li",{children:"‚Ä¢ Contactez le support si le probl√®me persiste"})]})]})]})}),v&&!x&&L.length===0&&e.jsx("div",{className:"sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6 mb-8",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"üì° Service temporairement indisponible"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"Les missions ne peuvent pas √™tre charg√©es pour le moment. Veuillez r√©essayer dans quelques instants."})]})}),!x&&!g&&I.map(n=>e.jsx(Ee,{mission:n,onClick:()=>o(`/missions/${n.id}`)},n.id)),!x&&!g&&I.length===0&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-gray-300 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L10 8.586 8.707 7.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("p",{className:"text-gray-500 text-lg",children:["Aucune mission trouv√©e (",L.length," missions totales)"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Essayez de modifier vos filtres"})]})]})]})]})}export{cs as default};
