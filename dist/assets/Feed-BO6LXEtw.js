import{r,j as e}from"./ui-D9tbKjPW.js";import{m as f}from"./mvpStore-mrMlMRB0.js";import{I as F,B as l,a as I,u as M,x as R,S as w,e as N,T as $,y as z,d as S,H as C,i as L}from"./index-Bl4VChHa.js";import{S as D}from"./search-BfeaDq9r.js";import{F as E}from"./filter-DNdUOpeC.js";import{M as A}from"./message-circle-6uyhu5f2.js";import"./vendor-D3F3s8fL.js";function H(){return"xxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){const o=Math.random()*16|0;return(d==="x"?o:o&3|8).toString(16)})}function O({onSaved:d}){const[o,c]=r.useState(""),[j,n]=r.useState([]),h="me";async function u(i){i.preventDefault();const x=[];for(const g of j){const v=URL.createObjectURL(g);x.push(v)}const m={id:H(),userId:h,title:o||"Article sans titre",images:x,isPublic:!0,createdAt:new Date().toISOString(),likes:[]};f.addArticle(m),c(""),n([]),d&&d(m)}return e.jsxs("form",{onSubmit:u,className:"border rounded p-4 space-y-3 bg-white shadow-sm",children:[e.jsx("h3",{className:"font-semibold",children:"Ajouter un article Ã  ton dressing"}),e.jsx(F,{placeholder:"Titre (ex: Veste en jean)",value:o,onChange:i=>c(i.target.value)}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:i=>n(Array.from(i.target.files||[]))}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{type:"submit",children:"Enregistrer"}),e.jsx(l,{variant:"ghost",onClick:()=>{c(""),n([])},children:"Annuler"})]})]})}function X(){const[d,o]=r.useState([]),[c,j]=r.useState([]),[n,h]=r.useState(!1),[u,i]=r.useState(""),[x,m]=r.useState("all"),{user:g}=I(),[,v]=M(),{t}=R();function p(){const s=f.getArticles().filter(b=>b.isPublic);o(s),j(f.getProfiles())}r.useEffect(()=>{p()},[]);const k=d.filter(s=>u?s.title.toLowerCase().includes(u.toLowerCase()):!0),P=s=>{f.toggleLike(s,g?.id?.toString()||"me"),p()},T=s=>{v(`/feed/${s}`)},U=s=>{f.toggleBookmark(s,g?.id?.toString()||"me"),p()};return e.jsxs("div",{className:"min-h-screen bg-cream dark:bg-gray-950",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white/90 dark:bg-gray-950/90 backdrop-blur-md border-b border-stone-200 dark:border-stone-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-6 h-6 text-stone-600 dark:text-stone-400"}),e.jsx("h1",{className:"text-2xl font-display font-bold text-stone-900 dark:text-stone-50",children:t("feed.title")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx(F,{placeholder:t("feed.searchPlaceholder"),className:"pl-10 bg-white dark:bg-gray-900 border-stone-300 dark:border-stone-700",value:u,onChange:s=>i(s.target.value)})]}),e.jsxs(l,{onClick:()=>h(!n),className:"bg-stone-900 dark:bg-stone-100 hover:bg-stone-800 dark:hover:bg-stone-200 text-white dark:text-stone-900",children:["+ ",t("feed.addLook")]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2",children:[e.jsxs(N,{variant:x==="all"?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>m("all"),children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),t("feed.allLooks")]}),e.jsxs(N,{variant:x==="trending"?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>m("trending"),children:[e.jsx($,{className:"w-3 h-3 mr-1"}),t("feed.trending")]}),e.jsxs(N,{variant:x==="following"?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>m("following"),children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),t("feed.following")]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[n&&e.jsx("div",{className:"mb-8 animate-in fade-in slide-in-from-top duration-300",children:e.jsx(S,{className:"p-6 border border-stone-200 dark:border-stone-800 bg-white dark:bg-gray-950 shadow-sm",children:e.jsx(O,{onSaved:()=>{p(),h(!1)}})})}),k.length===0&&!n&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-stone-100 dark:bg-stone-800 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"w-12 h-12 text-stone-600 dark:text-stone-400"})}),e.jsx("h3",{className:"text-2xl font-display font-bold text-stone-900 dark:text-stone-50 mb-2",children:t("feed.noLooks")}),e.jsx("p",{className:"text-stone-600 dark:text-stone-400 mb-6",children:t("feed.noLooksMessage")}),e.jsxs(l,{onClick:()=>h(!0),className:"bg-stone-900 dark:bg-stone-100 hover:bg-stone-800 dark:hover:bg-stone-200 text-white dark:text-stone-900",children:["+ ",t("feed.createFirstLook")]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:k.map(s=>{const b=c.find(a=>a.id===s.userId)||{name:"Utilisateur"},y=s.likes?.includes(g?.id?.toString()||"me"),B=s.likes?.length||0;return e.jsxs(S,{className:"group overflow-hidden hover:shadow-lg transition-all duration-300 border border-stone-200 dark:border-stone-800 hover:border-stone-400 dark:hover:border-stone-600 cursor-pointer bg-white dark:bg-gray-950",children:[e.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-gray-100",children:[e.jsx("img",{src:s.images?.[0]||"https://via.placeholder.com/400x600?text=Look",alt:s.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex gap-2",children:[e.jsx(l,{size:"sm",variant:"secondary",className:"flex-1 bg-white/90 hover:bg-white",onClick:a=>{a.stopPropagation(),P(s.id)},children:e.jsx(C,{className:`w-4 h-4 ${y?"fill-pink-500 text-pink-500":""}`})}),e.jsx(l,{size:"sm",variant:"secondary",className:"flex-1 bg-white/90 hover:bg-white",onClick:a=>{a.stopPropagation(),T(s.id)},"data-testid":`button-comment-${s.id}`,children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx(l,{size:"sm",variant:"secondary",className:"flex-1 bg-white/90 hover:bg-white",onClick:a=>{a.stopPropagation(),U(s.id)},"data-testid":`button-bookmark-${s.id}`,children:e.jsx(L,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white text-xs font-semibold",children:b.name.split(" ").map(a=>a[0]).join("").toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-900 truncate",children:b.name}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString("fr-FR")})]})]}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2 line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{className:`w-4 h-4 ${y?"fill-pink-500 text-pink-500":""}`}),e.jsx("span",{className:"font-medium",children:B})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"0"})]}),e.jsx("div",{className:"flex items-center gap-1 ml-auto",children:e.jsx(L,{className:"w-4 h-4"})})]})]})]},s.id)})}),k.length>0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(w,{className:"w-8 h-8 mx-auto mb-3 text-pink-300"}),e.jsx("p",{children:"Tu as tout vu ! Reviens plus tard pour plus d'inspiration."})]})]})]})}export{X as default};
